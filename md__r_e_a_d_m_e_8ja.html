<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Authlete: C# 用 Authlete ライブラリ</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Authlete
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md__r_e_a_d_m_e_8ja.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">C# 用 Authlete ライブラリ </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>概要 </h2>
<p><a href="https://docs.authlete.com/">Authlete Web APIs</a> のための C# ライブラリです。</p>
<p><a href="https://www.authlete.com/">Authlete</a> は <a href="http://tools.ietf.org/html/rfc6749">OAuth 2.0</a> と <a href="http://openid.net/connect/">OpenID Connect</a> の実装を提供するクラウドサービスです。 Authlete が提供する Web API を使い、DB-less (データベース無し) の認可サーバーを構築することができます。「DB-less」とは、認可データ (アクセストークン等)、 認可サーバーの設定、クライアントアプリケーションの設定を保存するデータベースを管理する必要が無い、という意味です。 これらのデータはクラウド上にある Authlete サーバーに保存されます。</p>
<p>Authlete のアーキテクチャーの詳細については、 <em><a href="https://medium.com/@darutk/new-architecture-of-oauth-2-0-and-openid-connect-implementation-18f408f9338d">New Architecture of OAuth 2.0 and OpenID Connect Implementation</a></em> をお読みください。真のエンジニアであれば、このアーキテクチャーを気に入ってくれるはずです ;-) なお、日本語版は「<a href="https://qiita.com/TakahikoKawasaki/items/b2a4fc39e0c1a1949aab">OAuth 2.0 / OIDC 実装の新アーキテクチャー</a>」です。</p>
<blockquote class="doxtable">
<p>The primary advantage of this architecture is in that the backend service can focus on implementing OAuth 2.0 and OpenID Connect without caring about other components such as identity management, user authentication, login session management, API management and fraud detection. And, consequently, it leads to another major advantage which enables the backend service (implementation of OAuth 2.0 and OpenID Connect) to be combined with any solution of other components and thus gives flexibility to frontend server implementations.</p>
<p>このアーキテクチャーの一番の利点は、アイデンティティー管理やユーザー認証、 ログインセッション管理、API 管理、不正検出などの機能について気にすることなく、 バックエンドサービスが OAuth 2.0 と OpenID Connect の実装に集中できることにあります。 この帰結として、バックエンドサービス (OAuth 2.0 と OpenID Connect の実装) をどのような技術部品とも組み合わせることが可能というもう一つの大きな利点が得られ、 フロントエンドサーバーの実装に柔軟性がもたらされます。 </p>
</blockquote>
<h2>ライセンス </h2>
<p>Apache License, Version 2.0</p>
<h2>ソースコード (authlete-csharp) </h2>
<p><code><a href="https://github.com/authlete/authlete-csharp">https://github.com/authlete/authlete-csharp</a></code></p>
<h2>API リファレンス (authlete-csharp) </h2>
<p><code><a href="https://authlete.github.io/authlete-csharp/">https://authlete.github.io/authlete-csharp/</a></code></p>
<h2>API リファレンス (Authlete) </h2>
<p><code><a href="https://docs.authlete.com/">https://docs.authlete.com/</a></code></p>
<h2>説明 </h2>
<h4>IAuthleteApi の取得方法</h4>
<p><a href="https://docs.authlete.com/">Authlete Web API</a> とやりとりするメソッドは全て <code>IAuthleteApi</code> インターフェースに集められています。 現在のところ、このインターフェースを実装するクラスは <code>AuthleteApi</code> クラスのみです。</p>
<p><code>AuthleteApi</code> クラスのコンストラクターは <code>IAuthleteConfiguration</code> インターフェースの実装を要求します。 <code>IAuthleteConfiguration</code> インタフェースの実装が用意できれば、次のようにして <code>AuthleteApi</code> のインスタンスを作成することができます。</p>
<div class="fragment"><div class="line">// Authlete Web API にアクセスするための設定を用意する。</div><div class="line">IAuthleteConfiguration conf = ...;</div><div class="line"></div><div class="line">// IAuthleteApi を実装するインスタンスを生成する。</div><div class="line">IAuthleteApi api = new AuthleteApi(conf);</div></div><!-- fragment --><p><code>IAuthleteConfiguration</code> は、Authlete サーバーの URL やサービスの API クレデンシャルズなどの、Authlete Web API にアクセスするのに必要な設定値を保持するインターフェースです。 具体的には、このインターフェースには次のようなプロパティー群があります。</p>
<table class="doxtable">
<tr>
<th align="left">プロパティー </th><th align="left">説明  </th></tr>
<tr>
<td align="left"><code>BaseUrl</code> </td><td align="left">Authlete サーバーの URL </td></tr>
<tr>
<td align="left"><code>ServiceApiKey</code> </td><td align="left">サービスの API キー </td></tr>
<tr>
<td align="left"><code>ServiceApiSecret</code> </td><td align="left">サービスの API シークレット </td></tr>
<tr>
<td align="left"><code>ServiceOwnerApiKey</code> </td><td align="left">あなたのアカウントの API キー </td></tr>
<tr>
<td align="left"><code>ServiceOwnerApiSecret</code> </td><td align="left">あなたのアカウントの API シークレット </td></tr>
</table>
<p>authlete-csharp には <code>IAuthleteConfiguration</code> インターフェースの実装が三つ含まれています。</p>
<table class="doxtable">
<tr>
<th align="left">クラス </th><th align="left">説明  </th></tr>
<tr>
<td align="left"><code>AuthleteEnvConfiguration</code> </td><td align="left">環境変数による設定 </td></tr>
<tr>
<td align="left"><code>AuthletePropertiesConfiguration</code> </td><td align="left">プロパティーファイルによる設定 </td></tr>
<tr>
<td align="left"><code>AuthleteSimpleConfiguration</code> </td><td align="left">C# プロパティーによる設定 </td></tr>
</table>
<h4>AuthletePropertiesConfiguration</h4>
<p><code>IAuthleteConfiguration</code> インターフェースの三つの実装のうち、ここでは <code>AuthletePropertiesConfiguration</code> クラスについて説明します。</p>
<p><code>AuthletePropertiesConfiguration</code> クラスは、Authlete Web API へのアクセスに必要な設定をプロパティーファイルでおこなう仕組みを提供します。 ここでいうプロパティーファイルとは、Java の世界で用いられる設定ファイルの一種です。 ファイルフォーマットの仕様は <code>java.util.Properties.load(java.io.Reader)</code> の <a href="https://docs.oracle.com/javase/9/docs/api/java/util/Properties.html#load-java.io.Reader-">JavaDoc</a> に記述されています。 authlete-csharp には、プロパティーファイルフォーマットを解釈する実装 (<code>Authlete.Util.Properties</code>) が含まれています。</p>
<p><code>AuthletePropertiesConfiguration</code> には三つのコンストラクターがあります。 下記はそれらの使用例です。</p>
<div class="fragment"><div class="line">// (1) 引数無しのコンストラクター。 &quot;authlete.properties&quot; という</div><div class="line">//     名前のファイルを読もうとする。 AUTHLETE_CONFIGURATION_FILE</div><div class="line">//     という環境変数を用いて他のファイル名を指定することもできる。</div><div class="line">IAuthleteConfiguration conf =</div><div class="line">    new AuthletePropertiesConfiguration();</div><div class="line"></div><div class="line">// (2) 設定ファイル名を引数にとるコンストラクター。</div><div class="line">IAuthleteConfiguration conf =</div><div class="line">    new AuthletePropertiesConfiguration(&quot;authlete.properties&quot;);</div><div class="line"></div><div class="line">// (3) TextReader を引数にとるコンストラクター。</div><div class="line">using (TextReader reader = File.OpenText(&quot;authlete.properties&quot;))</div><div class="line">{</div><div class="line">    IAuthleteConfiguration conf =</div><div class="line">        new AuthletePropertiesConfiguration(reader);</div><div class="line">}</div></div><!-- fragment --><p><code>AuthletePropertiesConfiguration</code> クラスは、与えられた設定ファイル内に次の項目があることを期待しています。</p>
<table class="doxtable">
<tr>
<th align="left">プロパティーキー </th><th align="left">説明  </th></tr>
<tr>
<td align="left"><code>base_url</code> </td><td align="left">Authlete サーバーの URL </td></tr>
<tr>
<td align="left"><code>service.api_key</code> </td><td align="left">サービスの API キー </td></tr>
<tr>
<td align="left"><code>service.api_secret</code> </td><td align="left">サービスの API シークレット </td></tr>
<tr>
<td align="left"><code>service_owner.api_key</code> </td><td align="left">あなたのアカウントの API キー </td></tr>
<tr>
<td align="left"><code>service_owner.api_secret</code> </td><td align="left">あなたのアカウントの API シークレット </td></tr>
</table>
<p>下記は設定ファイルの例です。</p>
<div class="fragment"><div class="line">base_url                 = https://api.authlete.com</div><div class="line">service_owner.api_key    = 1532787510</div><div class="line">service_owner.api_secret = 9Y0ZARGatedJRhsYLNfiK_aKQIBCug2O3JQU6srZrpk</div><div class="line">service.api_key          = 9463955934</div><div class="line">service.api_secret       = AAw0rner_wjRCpk-y1A6J9s20Bvez3GxEBoL9jOJVR0</div></div><!-- fragment --><h4>IAuthleteApi の設定</h4>
<p><code>IAuthleteApi</code> の <code>Settings</code> プロパティーは <code>ISettings</code> インターフェースの実装を返します。 これを介して <code>IAuthleteApi</code> インターフェースの実装の動作を調整することができます。</p>
<div class="fragment"><div class="line">// IAuthleteApi インターフェースの実装を取得する。</div><div class="line">IAuthleteApi api = ...;</div><div class="line"></div><div class="line">// 実装の設定を保持するインスタンスを取得する。</div><div class="line">ISettings settings = api.Setting;</div><div class="line"></div><div class="line">// ネットワークタイムアウトをセットする。</div><div class="line">//</div><div class="line">// 現在の実装では Timeout プロパティーにセットされた値は</div><div class="line">// HttpClient.Timeout に渡される。</div><div class="line">//</div><div class="line">settings.Timeout = TimeSpan.FromSeconds(5);</div></div><!-- fragment --><h4>IAuthleteApi メソッドのカテゴリー</h4>
<p><code>IAuthleteApi</code> インターフェースのメソッド群は幾つかのカテゴリーに分けることができます。</p>
<ol type="1">
<li>認可エンドポイント実装のためのメソッド群<ul>
<li><code>Authorization(AuthorizationRequest)</code></li>
<li><code>AuthorizationFail(AuthorizationFailRequest)</code></li>
<li><code>AuthorizationIssue(AuthorizationIssueRequest)</code></li>
</ul>
</li>
<li>トークンエンドポイント実装のためのメソッド群<ul>
<li><code>Token(TokenRequest)</code></li>
<li><code>TokenFail(TokenFailRequest)</code></li>
<li><code>TokenIssue(TokenIssueRequest)</code></li>
</ul>
</li>
<li>サービス管理のためのメソッド群<ul>
<li><code>CreateService(Service)</code></li>
<li><code>DeleteService(long serviceApiKey)</code></li>
<li><code>GetService(long serviceApiKey)</code></li>
<li><code>GetServiceList()</code></li>
<li><code>GetServiceList(int start, int end)</code></li>
<li><code>UpdateService(Service)</code></li>
</ul>
</li>
<li>クライアントアプリケーション管理のためのメソッド群<ul>
<li><code>CreateClient(Client)</code></li>
<li><code>DeleteClient(long clientId)</code></li>
<li><code>GetClient(long clientId)</code></li>
<li><code>GetClientList()</code></li>
<li><code>GetClientList(int start, int end)</code></li>
<li><code>UpdateClient(Client)</code></li>
<li><code>RefreshClientSecret(long)</code></li>
<li><code>RefreshClientSecret(String)</code></li>
<li><code>UpdateClientSecret(long, string)</code></li>
<li><code>UpdateClientSecret(String, string)</code></li>
</ul>
</li>
<li>アクセストークンの情報取得のためのメソッド群<ul>
<li><code>Introspection(IntrospectionRequest)</code></li>
<li><code>StandardIntrospection(StandardIntrospectionRequest)</code></li>
</ul>
</li>
<li>アクセストークン取り消しエンドポイント実装のためのメソッド群<ul>
<li><code>Revocation(RevocationRequest)</code></li>
</ul>
</li>
<li>ユーザー情報エンドポイント実装のためのメソッド群<ul>
<li><code>Userinfo(UserInfoRequest)</code></li>
<li><code>UserinfoIssue(UserInfoIssueRequest)</code></li>
</ul>
</li>
<li>JWK セットエンドポイント実装のためのメソッド群<ul>
<li><code>GetServiceJwks()</code></li>
<li><code>GetServiceJwks(bool pretty, bool includePrivateKeys)</code></li>
</ul>
</li>
<li>OpenID Connect Discovery のためのメソッド群<ul>
<li><code>GetServiceConfiguration()</code></li>
<li><code>GetServiceConfiguration(bool pretty)</code></li>
</ul>
</li>
<li>トークン操作のためのメソッド群<ul>
<li><code>TokenCreate(TokenCreateRequest)</code></li>
<li><code>TokenUpdate(TokenUpdateRequest)</code></li>
</ul>
</li>
<li>付与されたスコープの記録に関するメソッド群<ul>
<li><code>GetGrantedScopes(long clientId, string subject)</code></li>
<li><code>DeleteGrantedScopes(long clientId, string subject)</code></li>
</ul>
</li>
<li>ユーザー・クライアント単位の認可管理に関するメソッド群<ul>
<li><code>DeleteClientAuthorization(long clientId)</code></li>
<li><code>GetClientAuthorizationList(ClientAuthorizationGetListRequest request)</code></li>
<li><code>UpdateClientAuthorization(long clientId, ClientAuthorizationUpdateRequest request)</code></li>
</ul>
</li>
</ol>
<p><em>例</em></p>
<p>次のコードは既存のサービスのリストを取得する例です。 各サービスは一つの認可サーバーに対応します。</p>
<div class="fragment"><div class="line">// Authlete API にアクセスするための設定を用意する。ここでは</div><div class="line">// IAuthleteConfiguration インターフェースの実装の一つとして</div><div class="line">// AuthleteSimpleConfiguration を用いている。前述のとおり、</div><div class="line">// AuthletePropertiesConfiguration など、他の実装もある。</div><div class="line">IAuthleteConfiguration conf = new AuthleteSimpleConfiguration</div><div class="line">{</div><div class="line">    BaseUrl               = &quot;https://api.authlete.com&quot;,</div><div class="line">    ServiceOwnerApiKey    = &quot;1532787510&quot;,</div><div class="line">    ServiceOwnerApiSecret = &quot;9Y0ZARGatedJRhsYLNfiK_aKQIBCug2O3JQU6srZrpk&quot;,</div><div class="line">    ServiceApiKey         = &quot;9463955934&quot;,</div><div class="line">    ServiceApiSecret      = &quot;AAw0rner_wjRCpk-y1A6J9s20Bvez3GxEBoL9jOJVR0&quot;</div><div class="line">};</div><div class="line"></div><div class="line">// IAuthleteApi インターフェースの実装を取得する。</div><div class="line">// 現在のところ IAuthleteApi インターフェースを</div><div class="line">// 実装しているのは AuthleteApi クラスのみ。</div><div class="line">IAuthleteApi api = new AuthleteApi(conf);</div><div class="line"></div><div class="line">// サービスのリストを取得する。</div><div class="line">ServiceListResponse response = await api.GetServiceList();</div></div><!-- fragment --><h4>ハンドラー</h4>
<p><code>IAuthleteApi</code> インターフェースのメソッド群だけを用いて認可サーバーや OpenID プロバイダーを開発することも可能ですが、<code>Authlete.Handler</code> 名前空間にあるユーティリティークラス群を用いることで、作業はもっと簡単になります。</p>
<p>TODO: ハンドラーに関する説明をここに記述する。</p>
<h2>TODO </h2>
<ul>
<li>ハンドラーに関する説明を記述する。</li>
</ul>
<h2>コンタクト </h2>
<table class="doxtable">
<tr>
<th align="left">目的 </th><th align="left">メールアドレス  </th></tr>
<tr>
<td align="left">一般 </td><td align="left"><a href="#" onclick="location.href='mai'+'lto:'+'inf'+'o@'+'aut'+'hl'+'ete'+'.c'+'om'; return false;">info@<span style="display: none;">.nosp@m.</span>auth<span style="display: none;">.nosp@m.</span>lete.<span style="display: none;">.nosp@m.</span>com</a> </td></tr>
<tr>
<td align="left">営業 </td><td align="left"><a href="#" onclick="location.href='mai'+'lto:'+'sal'+'es'+'@au'+'th'+'let'+'e.'+'com'; return false;">sales<span style="display: none;">.nosp@m.</span>@aut<span style="display: none;">.nosp@m.</span>hlete<span style="display: none;">.nosp@m.</span>.com</a> </td></tr>
<tr>
<td align="left">広報 </td><td align="left"><a href="#" onclick="location.href='mai'+'lto:'+'pr@'+'au'+'thl'+'et'+'e.c'+'om'; return false;">pr@au<span style="display: none;">.nosp@m.</span>thle<span style="display: none;">.nosp@m.</span>te.co<span style="display: none;">.nosp@m.</span>m</a> </td></tr>
<tr>
<td align="left">技術 </td><td align="left"><a href="#" onclick="location.href='mai'+'lto:'+'sup'+'po'+'rt@'+'au'+'thl'+'et'+'e.c'+'om'; return false;">suppo<span style="display: none;">.nosp@m.</span>rt@a<span style="display: none;">.nosp@m.</span>uthle<span style="display: none;">.nosp@m.</span>te.c<span style="display: none;">.nosp@m.</span>om</a> </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
